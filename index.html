import React, { useState } from "react";
import { motion } from "framer-motion";

export default function RomanticApology() {
  const [noPosition, setNoPosition] = useState({ top: 0, left: 0 });
  const [accepted, setAccepted] = useState(false);
  const [noText, setNoText] = useState("No ğŸ˜…");
  const [noAttempts, setNoAttempts] = useState(0);
  const [showHearts, setShowHearts] = useState(false);
  const [showExplosion, setShowExplosion] = useState(false);
  const [showSecret, setShowSecret] = useState(false);

  const flirtyMessages = [
    "Are you sure? ğŸ‘€",
    "Oyee, be nice ğŸ˜Œ",
    "You donâ€™t mean that ğŸ˜",
    "Thatâ€™s not very forgiving of you ğŸ’‹",
    "Come on babyâ€¦ you love me really â¤ï¸",
    "Okay now youâ€™re just being mean ğŸ˜­",
  ];

  const moveNoButton = () => {
    const randomTop = Math.floor(Math.random() * 200) - 100;
    const randomLeft = Math.floor(Math.random() * 200) - 100;

    setNoPosition({ top: randomTop, left: randomLeft });
    setNoAttempts((prev) => prev + 1);

    const randomMessage =
      flirtyMessages[Math.floor(Math.random() * flirtyMessages.length)];
    setNoText(randomMessage);
  };

  const handleYesClick = () => {
    setShowExplosion(true);

    setTimeout(() => {
      setAccepted(true);
      setShowSecret(true);
    }, 600);
  };

  return (
    <div style={{
      minHeight: "100vh",
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      background: "linear-gradient(to bottom right, #fbcfe8, #ffe4e6, #e9d5ff)",
      padding: "24px",
      position: "relative",
      overflow: "hidden"
    }}>
      {showExplosion && (
        <div style={{
          position: "absolute",
          inset: 0,
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          pointerEvents: "none"
        }}>
          {Array.from({ length: 16 }).map((_, i) => {
            const angle = (i / 16) * 2 * Math.PI;
            const radius = 160;
            return (
              <motion.div
                key={i}
                initial={{ opacity: 1, scale: 0.5 }}
                animate={{
                  x: Math.cos(angle) * radius,
                  y: Math.sin(angle) * radius,
                  opacity: 0,
                  scale: 1,
                }}
                transition={{ duration: 0.8 }}
                style={{ position: "absolute", fontSize: "28px" }}
              >
                ğŸ’–
              </motion.div>
            );
          })}
        </div>
      )}

      <motion.div style={{ width: "100%", maxWidth: "700px", textAlign: "center" }}>
        {!accepted ? (
          <>
            <h1 style={{ fontSize: "28px", marginBottom: "24px", color: "#be185d" }}>
              Shristi â¤ï¸
            </h1>

            <p style={{ fontSize: "18px", marginBottom: "24px", lineHeight: 1.6 }}>
              Thereâ€™s no excuse for not putting in effort when it comes to you.
              When things feel heavy, love should get stronger â€” not quieter.
              I want you. I want us. And Iâ€™m choosing to step up.
            </p>

            <p style={{ fontSize: "18px", marginBottom: "24px", color: "#db2777" }}>
              Will you forgive me and let me take you on a proper date? ğŸ’
            </p>

            <div style={{ marginBottom: "24px" }}>
              <div style={{
                width: "100%",
                background: "#fecdd3",
                borderRadius: "999px",
                height: "10px",
                overflow: "hidden"
              }}>
                <motion.div
                  initial={{ width: 0 }}
                  animate={{ width: `${Math.min(noAttempts * 20, 100)}%` }}
                  transition={{ duration: 0.4 }}
                  style={{ height: "10px", background: "#f43f5e" }}
                />
              </div>
            </div>

            <div style={{ display: "flex", justifyContent: "center", gap: "24px", position: "relative", height: "80px" }}>
              <div
                onMouseEnter={() => setShowHearts(true)}
                onMouseLeave={() => setShowHearts(false)}
                style={{ position: "relative" }}
              >
                {showHearts && (
                  <div style={{ position: "absolute", top: "-30px", left: "50%", transform: "translateX(-50%)" }}>
                    ğŸ’• ğŸ’– ğŸ’˜
                  </div>
                )}
                <button
                  onClick={handleYesClick}
                  style={{ padding: "12px 24px", fontSize: "16px", borderRadius: "16px", border: "none", background: "#ec4899", color: "white", cursor: "pointer" }}
                >
                  {noAttempts >= 3 ? "Please Just Say Yes" : "Yes"}
                </button>
              </div>

              {noAttempts < 7 && (
                <div style={{ position: "relative", top: noPosition.top, left: noPosition.left }}>
                  <button
                    onMouseEnter={moveNoButton}
                    style={{ padding: "12px 24px", fontSize: "16px", borderRadius: "16px", border: "none", background: "#9ca3af", color: "white", cursor: "pointer" }}
                  >
                    {noAttempts >= 5 ? "Okay fine you win ğŸ˜­" : noText}
                  </button>
                </div>
              )}
            </div>
          </>
        ) : (
          <div style={{ maxWidth: "900px" }}>
            <h2 style={{ fontSize: "26px", marginBottom: "16px", color: "#be185d" }}>
              I already knew itttt!!! ğŸ’˜
            </h2>

            <p style={{ marginBottom: "16px" }}>
              Thank you for giving us another chance. I wonâ€™t take that lightly.
            </p>

            {showSecret && (
              <p style={{ marginBottom: "32px", color: "#db2777" }}>
                From our first laugh togetherâ€¦ to now. I still choose you. â¤ï¸
              </p>
            )}

            <div style={{ columnCount: 2, columnGap: "16px" }}>
              {["photo1.jpg","photo2.jpg","photo3.jpg","photo4.jpg","photo5.jpg","photo6.jpg"].map((src, index) => (
                <div key={index} style={{ breakInside: "avoid", marginBottom: "16px", borderRadius: "16px", overflow: "hidden", boxShadow: "0 10px 20px rgba(0,0,0,0.15)" }}>
                  <img
                    src={`/${src}`}
                    alt={`Memory ${index + 1}`}
                    style={{ width: "100%", display: "block" }}
                  />
                </div>
              ))}
            </div>
          </div>
        )}
      </motion.div>
    </div>
  );
}
